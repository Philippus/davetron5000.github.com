
<!DOCTYPE html>
<html language="en"><head>
  <meta charset="utf-8">
  <title>naildrivin5.com - David Bryant Copeland's Website</title>
  <meta name="author" content="David Bryant Copeland">
  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/images/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/images/favicons/ms-icon-144x144.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  

  
  <meta name="description" content="
  
  
  
    
      
        
        One Week of using my iPad for personal stuff at work
        
        January 10, 2011
      
      
       ...">
  

  
  <link rel="canonical" href="http://naildrivin5.com/page11/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="naildrivin5.com - David Bryant Copeland's Website" type="application/atom+xml">
  <link href="/css/styles.css" rel="stylesheet">
  <script src="https://use.typekit.net/ylm4zpa.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>
            
  <meta name="google-site-verification" content="h_yTpXa6N3ebHj8DYmgX4lIFGHBW1NtGMVHfXuu7i_4" />
</head>
<body>
  <header class="site-header pb2 mb2 center">
    <h1 class="uc ls2 f1"><a href="/">naildrivin5.com</a></h1>
    <h2 class="ls1"><small class="uc h4">Website of</small> David Bryant Copeland</h2>
    <nav>
      <ul>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/">Blog</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/bio">About</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/books">Books</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/talks">Talks</a></li>
      </ul>
      <div style="clear: both"></div>
    </nav>
  </header>
  <main>
    <section>
      <div class="blog-index">
  
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/01/10/2010-one-weed-of-ipad.html">One Week of using my iPad for personal stuff at work</a></h1>
        
        <h2 class="f6 mtneg">January 10, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>On Jan 3, I <a href="http://twitter.com/#!/davetron5000/status/21943399506509824">tweeted</a>:</p>

<blockquote>
<p>All personal stuff only on iPad; no twitter, email, or RSS on work computer. Will it keep me more focused?</p>
</blockquote>

<p>Essentially, what I decided to try doing was to bring my iPad to work every day, and use it for Twitter, RSS, and personal emails.  The only &quot;personal&quot; stuff I would be doing on my work machine would be IM, simply because the IM experience on iPad is not very good, and the immediacy of it would be lost on a computer that&#39;s not right in front of me.  I don&#39;t do a lot of personal IM&#39;ing anyway, so this seemed like a good compromise.</p>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/01/10/2010-one-weed-of-ipad.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/01/01/2010-whats-next.html">2010 in review; what's next for me in 2011</a></h1>
        
        <h2 class="f6 mtneg">January 01, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>Yesterday, while waiting for guests to arrive at my mostly-annual New Year&#39;s Eve party, I found a txt file I created called <code>2010_goals.txt</code>.  It&#39;s contents:</p>

<ul>
<li>speak at at least one more user&#39;s group</li>
<li>speak at some sort of conference</li>
<li>deploy an App to the iPhone App Store</li>
<li>Deploy a Rails 2 app to Heroku</li>
</ul>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/01/01/2010-whats-next.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/08/24/static-vs-dynamic-typing-is-typing.html">Static vs. Dynamic Typing: A matter of keystrokes?</a></h1>
        
        <h2 class="f6 mtneg">August 24, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>In Java, I almost <em>never</em> make type errors.  The type errors that are possible in Java fall roughly into two categories:</p>

<ol>
<li> Using an object of the wrong type (this is caught by the compiler)</li>
<li> Casting an object to a more specific type at runtime (this can only be caught by tests or users :)</li>
</ol>

<p>I&#39;d make error #1 on occasion, but the compiler catches it.  As to #2, before generics, I can count on my hands the number of times I got a bona-fide <code>ClassCastException</code> at runtime.  After generics?  Never.  </p>

<p>I don&#39;t mean just that I didn&#39;t experience these runtime type errors, but that they <em>didn&#39;t even make it to the compiler</em>.  If you think about how Java syntax works, it&#39;s no wonder:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">someList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">someList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;Foo&quot;</span><span class="o">);</span>
<span class="n">someList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;Bar&quot;</span><span class="o">);</span></code></pre></div>

<p>I had to type almost the exact same thing twice.  After about 2 days of using generics, my muscle memory literally <em>prevents</em> me from making type errors.  To even simulate one requires a pre-generics library call, or some herculean efforts.  An arguable win for static typing, if at the price of verbosity.</p>

<p>Of course, in Ruby, I make type errors all the time, especially when using new libraries I&#39;m not familiar with.  Ruby libraries rarely document the types of things (though they are frequently liberal with what they will accept).  The solution here is just better unit tests.  And that&#39;s a pretty good thing.  So, a slight negative for dynamic typing that leads us to a better tested system, reduced verbosity, and better productivity once the learning curve is dealth with.</p>

<p>This pretty well illustrates the tradeoffs between dynamic and static typing.  Case closed, right?</p>

<p>Enter Scala.  With Scala, I make type errors just as much as I do with Ruby.  The only difference is that the compiler catches them.   Here&#39;s the Scala equivalent to the Java code above</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">var</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="s">&quot;bar&quot;</span><span class="o">)</span></code></pre></div>

<p>Notce how I haven&#39;t specified a <em>single</em> type?  It&#39;s nearly identical to the Ruby version:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">list</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="s2">&quot;bar&quot;</span><span class="o">]</span></code></pre></div>

<p>These examples are obviously simplistic, but in a more complex system, Scala&#39;s type inferencer tends to be one
step ahead of me.  While it&#39;s handy that I have a compiler to catch these type errors, the fact remains that, despite Scala being a statically typed language, <em>I&#39;m making far more type errors than I would in Java</em>.</p>

<p>This seems kindof odd, but I think it&#39;s ultimately a win: I get the brevity and productivity of a dynamically typed language, but the safety of the compiler catching my type errors for me.</p>

<p>Scala puts a subtle spin on the &quot;static vs. dynamic&quot; debate, because you aren&#39;t annotating your types <em>nearly</em> as much as with Java, but you still get all the benefits.  I&#39;ve certainly heard many criticisims of static typing, but having the compiler check types for you wasn&#39;t one of them.</p>

<p>Of course, sometimes you <em>do</em> need to tell Scala what your types are, but, they seem to be exactly where you&#39;d want them anyway:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/** get users with the given name and age */</span>
<span class="k">def</span> <span class="n">getUsers</span><span class="o">(</span><span class="n">name</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span><span class="n">age</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">User</span><span class="o">]</span></code></pre></div>

<p>This says that we take a requires <code>String</code> and an optional <code>Int</code> and will return a list of <code>User</code> objects.  To give the same information in Ruby, you&#39;d need to:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Gets the users with the given name and age</span>
<span class="c1">#</span>
<span class="c1"># name - a String</span>
<span class="c1"># age - an Int or nil if not searching by age</span>
<span class="c1">#</span>
<span class="c1"># Returns an array of User objects</span>
<span class="k">def</span> <span class="nf">get_users</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="kp">nil</span><span class="p">)</span>
    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
<span class="k">end</span></code></pre></div>

<p><em>(Sure, you could leave off the comment, but do you really hate your fellow developers (<em>and</em> future you) that much?)</em></p>

<p><em>Now</em> which language is more verbose?  Perhaps the static/dynamic typing debate is really just about entering text?</p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/30/in-offense-of-scala-option.html">In "Offense" of Scala's Option class; a guarded defense of Cédric's rant</a></h1>
        
        <h2 class="f6 mtneg">July 30, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>In a <a href="http://beust.com/weblog/2010/07/28/why-scalas-option-and-haskells-maybe-types-wont-save-you-from-null/">recent blog entry</a>, Cédric Beust calls out scala&#39;s <code>Option</code> class as nothing more significant than null checks.  Commenters rightly set him straight that the thesis of his blog post was marred by an ignorance of idiomatic use of the class.</p>

<p>But, it&#39;s hard to really blame Cédric, when you look at what he had to go on.  Odersky&#39;s book states that one should use pattern matching with <code>Option</code>, and the scaladoc for Option is just abysmal:</p>

<blockquote>
<p>This class represents optional values. Instances of Option are either instances of case class Some or it is case object None.</p>
</blockquote>

<p>That is the <em>entire</em> description of the class, no examples, nothing.  Worse, the method that commenters called out as idiomatic, <code>flatMap</code>, has the following description:</p>

<blockquote>
<p>If the option is nonempty, return a function applied to its value. Otherwise return None.</p>
</blockquote>

<p>This is <em>not</em> what <code>Option#flatMap</code> actually appears to do (nor is documented to do; it&#39;s documented to return an <code>Option[B]</code>!):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">s</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">n</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">f</span> <span class="k">=</span> <span class="o">{</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Some</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="s">&quot;bar&quot;</span><span class="o">)</span> <span class="o">}</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="nc">Some</span><span class="o">(</span><span class="n">foobar</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">n</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="nc">None</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">s</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="n">r</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">java.lang.String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">foobar</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">getClass</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">java.lang.Class</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span> <span class="k">class</span> <span class="nc">scala</span><span class="o">.</span><span class="nc">Some</span></code></pre></div>

<p>It certainly doesn&#39;t call itself out as &quot;the way&quot; to use Option.  A simple example in the scaladoc could have gone a long way.</p>

<p>So, angry post + helpful commenters == problem solved, right?</p>

<p>Wrong.</p>

<p>The <code>Option</code> class is, really, an implementation of the <a href="http://en.wikipedia.org/wiki/Null_Object_pattern">NullObject</a> pattern, and a more elegant way to handle optional values.  In scala, we might have this method signature:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/**</span>
<span class="cm"> * Updates the full name</span>
<span class="cm"> * @param lastName the last name</span>
<span class="cm"> * @param firstName the first name</span>
<span class="cm"> */</span>
<span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span></code></pre></div>

<p>This means &quot;update my name; lastName is required and firstName is optional&quot;.  In java, this method might look like this:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**</span>
<span class="cm"> * Updates the full name</span>
<span class="cm"> * @param lastName the last name, may not be null</span>
<span class="cm"> * @param firstName the first name, may be null</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateName</span><span class="o">(</span><span class="n">String</span> <span class="n">lastName</span><span class="o">,</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">lastName</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;lastName required&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">StringBuffer</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">firstName</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">b</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span>
        <span class="n">b</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">this</span><span class="o">.</span><span class="na">fullName</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span></code></pre></div>

<p>So, what&#39;s the right way to do it in Scala?  According to the commentors:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">)</span>
  <span class="n">firstName</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span> <span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">)</span> <span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Yech.  Does anyone else think that calling a method called &quot;foreach&quot; on our &quot;optional value&quot; is just nonsensical?  Or that the <em>idiomatic way</em> to treat an optional value is <em>as a collection</em>, e.g. by using the <code>for</code> comprehension?  This just feels hacky.  Naming is one of the most important (and challenging) things in software engineering, and <code>Option</code>&#39;s API is an utter failure (even its name is wrong; when one has <em>an option</em>, one typicaly has many choices, not just one or nothing.  <em>Optional</em> is really what is meant here, so why are we afraid of adding a few more letters?  Especially given how &quot;precise&quot; some of the documentation is, mathematically speaking, why are we not being precise with English?). If <code>Option</code> is just shorthand for a &quot;list of zero or one elements&quot;, and we get no better methods than what comes with <code>List</code>, then what&#39;s even the point of the class?</p>

<p>I&#39;m not saying we remove all the collection methods from <code>Option</code>, but how about a throwing us a bone to make our code readable and learnable without running to the scaladoc (or REPL) to see what&#39;s going on?  I mean, there&#39;s a method on <code>Option</code> called <code>withFilter</code> whose documented purpose (I&#39;m not making this up) is: &quot;Necessary to keep Option from being implicitly converted to Iterable in for comprehensions&quot;.  Am I expected to believe that it&#39;s ok to have <em>this</em> hacky pile of cruft, but we can&#39;t get a readable method for &quot;do something to the contents if they are there&quot;?</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> 
  <span class="k">def</span> <span class="n">ifValue</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span> <span class="n">f</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">U</span> <span class="o">)</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="n">foreach</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">unlessValue</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span> <span class="n">f</span><span class="k">:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">U</span><span class="o">)</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="o">)</span> <span class="n">f</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">)</span>
  <span class="n">firstName</span><span class="o">.</span><span class="n">ifValue</span><span class="o">(</span> <span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">)</span> <span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Which would be less surprising?  Couple this with some better scaladoc:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/** This class represents an optional value.  </span>
<span class="cm"> *</span>
<span class="cm"> * To use as a null object:</span>
<span class="cm"> * val optional = getSomePossiblyOptionalValue</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * option.ifValue { (actualValue) =&gt; </span>
<span class="cm"> *   // do things with the value, if it was there</span>
<span class="cm"> * }</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> * or</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * optional.unlessValue { log.debug(&quot;missing optional value&quot;) }</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * To use as a Monad or collection:</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * val first8upper = option.flatMap( (y) =&gt; Some(y.toUpperCase) ).</span>
<span class="cm"> *                          flatMap( (y) =&gt; Some(y.substring(0,8)) )</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Option</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
  <span class="c1">// etc.</span>
<span class="o">}</span></code></pre></div>

<p>With these examples, you cover the two main uses of this class, show newcomers how to use it, and demonstrate its superiority over null checks.</p>

<p>It&#39;s frustrating to see this, because Scala has so much potential to be a lucid, accessible, readable language, but API usability and learnability are just not prioties.  Scala needs to take some lessons from Ruby in terms of API design (and Java in terms of API documentation).</p>

<p>Of course, none of this <em>does</em> save you from null, because Scala is perfectly happy to assign null to anything.  It kinda makes the whole thing seem a bit pointless.</p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/18/iphone-app-part-5.html">My first iPhone App - Part 5</a></h1>
        
        <h2 class="f6 mtneg">July 18, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/23/iphone-app-part-1.html">Part 1</a>, <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 2</a>, <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a>, and <a href="/blog/2010/07/08/iphone-app-part-4.html">Part 4</a> first</em></p>

<p>I&#39;ve been working on the app more than my recent lack of blog entries indicates.  At this point, I have what could roughly be called a beta version; almost all the features are there, and things seem to be generally working pretty well.  </p>

<h2>User Experience</h2>

<p>The biggest change in the UX is the ability to add tasting notes, date tasted, and location tasted.  This is a new screen accessible from the main entry screen.  The most obvious way to do this in my mind, was a big button at the bottom:</p>

<p><img src="/images/wine_brain_new_wine_5.jpg" alt="New Add Screen"></p>

<p>In designing the new screen, 
the &quot;where tasted&quot; and &quot;when tasted&quot; were straightforward; I used stock controls.  For the tasting notes, I needed a <code>UITextView</code>, which is akin to an HTML <code>TEXTAREA</code>.  The visual appearance of this control is pretty lacking compared to the <code>UITextField</code>; there is no nice beveled edge, no rounded corners, and no placeholder text.  I really just wanted a multi-line field much like the <code>UITextField</code>, but there is nothing available to create that.</p>

<p>So, I hacked something together.</p>

<p>An option for the <code>UITextField</code>&#39;s appearance is to have a beveled edge with square corners.  In this configuration, you can adjust the height of the text field.  So, I placed such a field on the screen and sized it about the size of my tasting notes field and made the background color white.  I then put the tasting notes field on top of it, with a clear background color, and, well, it looked pretty good:</p>

<p><img src="/images/wine_brain_new_wine_details.jpg" alt="Details Screen"></p>

<p>I then implemented some <code>UITextViewDelegate</code> methods to give the apperance of placeholder text:</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">textViewShouldBeginEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="n">DEFAULT_TASTING_NOTES_TEXT</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">textViewDidEndEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="n">length</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">DEFAULT_TASTING_NOTES_TEXT</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>I considered using some third-party controls that mimic this behavior, but didn&#39;t want to get side-tracked adding new frameworks to my app at this point.</p>

<h2>User Testing</h2>

<p>Once I had this, I handed my phone to Amy for some more user testing; She brought up a few obvious things that I had completely internalized and begun ignoring:</p>

<ul>
<li>Clicking &quot;Save&quot; on the details screen brought you back to the &quot;new wine&quot; screen, instead of just saving and bringing you back to the top.  A minor but obvious annoyance.</li>
<li>She kept tapping on the &quot;Choose Varietal&quot; text field, thinking that would bring up the varietal chooser, instead of clicking the much smaller blue &quot;disclosure&quot; button</li>
<li>She was a bit sad that the wines we had entered in the app would not be available on our shared Google Spreadsheet</li>
</ul>

<p>To smooth the navigation after saving, I used a stock feature of the <code>UINavigationController</code> to &quot;pop&quot; more than once up the chain.  Since my design of the details screen used Apple&#39;s delegate pattern (essentially, the &quot;add new wine&quot; view controller was the delegate to the details view&#39;s lifecycle; when you click &quot;Save&quot; on the detail view, it triggers a callback in the &quot;add new wine&quot; view controller; the perfect place to save before the detail view controller popped back two screens).</p>

<p>The problem with the &quot;Choose Varietal&quot; control had bugged me, too, but I got used to it and didn&#39;t think about it.  The solution was very simple, though hacky.  I placed a clear button on top of the field the exact size of the field and had it trigger the same action as the blue disclosure button.  Problem solved.</p>

<p>As to maintaining the list up on Google Docs, I think I may need to implement this sooner rather than later; I think it&#39;s important to be able to get your data out of an application, and Google Docs is a reasonably user-friendly way to do it (as opposed to emailing some CSV file).  </p>

<h2>Other Random Bits</h2>

<p>I still didn&#39;t get around to setting up iCuke for testing; I really should because I don&#39;t know what missing <code>retain</code> calls might be lurking.  I also finally created an icon, using a picture I took in Napa.  Not sure I like it, but it beats the white blob:</p>

<p><img src="/images/wine_brain_icon.png" alt="Icon"></p>

<p>(Taken from <a href="http://www.flickr.com/photos/davetron5000/3805675435/">my original</a>).</p>

<p>Finally, the app no longer starts up on the actual device.  A seemingly serious problem that I assume would be remedied by a re-install from scratch, however I have a few wines that I&#39;ve added and don&#39;t particularly wanted to lose them.  Not sure how I could gain access to the SQL database to get them out, but I&#39;m currently downloading the 4.0.1 update for my phone and the 2+ GB SDK update (!).</p>

<p><em>As a followup, I had to re-install the application from scratch, though I was able to access the SQLite database from an iTunes backup.  I <em>really</em> need to implement a quicker backup/export mechanism...</em></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/08/iphone-app-part-4.html">My first iPhone App - Part 4</a></h1>
        
        <h2 class="f6 mtneg">July 08, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/23/iphone-app-part-1.html">Part 1</a>, <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 2</a>, and <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a> first</em></p>

<p>The past week was spent trying to understand the best way to expand my application&#39;s features without have a ton of duplicated code or UI.
It was also a learning experience on Core Data.  Thankfully, <a href="http://www.stackoverflow.com">Stackoverflow</a> and its amazing contributers were very helpful.</p>

<h2>Core Data Blunders</h2>

<p>It started as I made my first foray into implementing the search screen (i.e. the home screen of my app):</p>

<p><img src="/images/wine_brain_homescreen.jpg" alt="Home Screen"></p>

<p>Three of the searches (most recent wines, wines by rating, and all wines) end up doing the same thing more or less: Query for some data, sort it a certain way, and show it in a <code>UITableView</code>.  I ended up creating a custom table cell view and I wanted all three to use it:</p>

<p><img src="/images/wine_brain_custom_cell.jpg" alt="Custom Cell"></p>

<p>Access to Core Data-provided entities is done through objects of the class <code>NSFetchedResultsController</code>, which takes what amounts to a database query and provides many ways of accessing the results, including caching, callbacks, and iteration.  When using a table view, you typically have your view controller handle callbacks for this class, which allows the table to update itself when items are added, removes, or changed.  All of this boilerplate is given to you at the start of the project.  So far so good.</p>

<p>My plan was to create additional <code>NSFetchedResultsController</code> instances inside my table view controller class and then switch between them.  A fine idea that lead that numerous random difficult-to-reproduce crashes.</p>

<p>It turns out the basic idea of what I was doing was good, but my implementation exposed a sore lack of understanding of how all this stuff fit together.  I&#39;m still not sure I fully grasp it (and wish the book I bought had a bit of a deeper dive into Core Data), but after some more reasoning, I got around it.  Essentially, leaving the unused <code>NSFetchedResultsController</code> instances connected to my table view <em>and</em> having caching turned on <em>and</em> not properly reloading data when switching searches created a situation where they were all pretty confused about the underlying state of the database.</p>

<p>With some judicious management of these instances, as well as disabling caching, I now have a fully-functional &quot;Recent Wines&quot;, &quot;Wines By Rating&quot; and fancy indexed &quot;All Wines&quot; view (index meaning I can jump to wines by letter, a la the Contacts application).</p>

<p>Unfortunately, the result of turning off caching is that it takes a noticable blip of time to summon any of these views.  I may just come full circle and end up with three different <code>UITableViewController</code> instances and NIBs just so I can leave Caching on.</p>

<h2>User Experience</h2>

<p>Once I had gotten back to a stable app, I loaded it up on my phone and headed into the field.  A few nights ago, Amy and I ended up at one of our favorite restaurants/wine bars in DC, <a href="http://www.proofdc.com">Proof</a>.  We&#39;ve been there several times, and many of their wines-by-the-glass are in the Wine Brain.  While they rotate their selections, I was curious as to what I&#39;d had there previously.  Unfortunately, I had yet to implement the search-by-location feature :)  Combing through the &quot;All Wines&quot; view was a bit frustrating.  This made obvious several features that are now on the top of my list (some planned previously, some not):</p>

<ul>
<li>Find wines by location</li>
<li>Actually <em>entering</em> the location at which I had a wine</li>
<li>Location-aware assistance of location (e.g. &quot;Are you at Proof?  Here&#39;s what you&#39;ve had there...&quot;)</li>
<li>Ability to text-search the &quot;all wines&quot; list</li>
</ul>

<p>The good news is that my cursory reading of my book and the API docs indicates that these things are going to be <em>very</em> easy to implement.</p>

<h2>Objective-C</h2>

<p>There&#39;s a lot to like about Objective-C, and a lot to dislike.  Even though the handling of multiple arguments is a bit strange, I find it actually results in fairly readable code.  It feels very Apple; different, but usable.  Even though it&#39;s a lot to type out something like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">NSString *stripped = [canonicalName stringByTrimmingCharactersInSet:
                       [NSCharacterSet whitespaceAndNewlineCharacterSet]];
</code></pre></div>
<p>It <em>is</em> pretty readable, regardless of what programming language you are coming from.  That being said, stack traces and error messages on crashes are nigh-useless, and the overall testability of iPhone apps is pretty behind the times.  This months <a href="http://pragprog.com/magazines">issue of Prag Prog&#39;s magazine</a> has an interesting article on <a href="http://github.com/unboxed/icuke">iCuke</a>, which I look forward to trying out.  I&#39;ve resulted to keeping a text file of test cases that I have to manually run through to make sure I haven&#39;t broken anything, and it feels, well, 1997.  The rumours of a Apple&#39;s switch to Ruby are too good to be true, but one can always dream.</p>

<p><em>Continued in <a href="/blog/2010/07/18/iphone-app-part-5.html">Part 5</a></em></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/06/29/iphone-app-part-3.html">My first iPhone App - Part 3</a></h1>
        
        <h2 class="f6 mtneg">June 29, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 1</a> and <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 2</a> first</em></p>

<p>Just a quick update for tonight.  I&#39;m starting to get the hang of how the user interface elements I create in Interface Builder get hooked up and become available in code.  It&#39;s a bit odd and not terribly intuitive, but it&#39;s starting to make a <em>bit</em> more sense.  Under the covers there&#39;s some sort of dependency injection going on (even if Apple doesn&#39;t call it that) that smells of Spring-style magic; objects get created for me and populated if I do the right thing.</p>

<p>At any rate, I decided that, before making any more changes, I needed to get a reasonable data set into the app.  I spent two painful hours exporting my Google Doc Wine Brain into CSV and parsing it with Objective-C, mapping it to my Core Data model objects.  In the end, I was successful, but, WOW, what a pain compared to Ruby or Perl.  </p>

<p>Seeing this large set of data on the home screen was very motivational to start working on a drill-down/search interface, as you can see here:</p>

<p><img src="/images/wine_brain_all_wines.jpg" alt="All Wines List"></p>

<p>Before delving into my new homescreen, I decided to work up a better color scheme that was more &quot;wine-like&quot;.  I&#39;m not a big fan of apps that have fancy graphics and obscure the idiomatic iPhone UI, but a bit of a color splash would go a long way (and, not to mention, be well within my graphic design skill level).  In addition, more user testing (via Amy once again) revealed that the rating control needed a much starker contrast between the selected and unselected choices.  There isn&#39;t much I have control over via the API for this, so I chose an alternate style of <code>UISegmentedControl</code> that used the &quot;iPhone blue&quot; for the selected state.  I think it works OK with the color scheme, though I&#39;d prefer the &quot;merlot red&quot; that I chose for the nav bar and wine type:</p>

<p><img src="/images/wine_brain_new_wine_4.jpg" alt="Colorrific New Wine Screen"></p>

<p>I&#39;m starting to think that my desire to have wine entry confined to one screen might not pan out.  The &quot;slot-machine&quot; control will become more and more unusable as more varietals are added, and there&#39;s really no way to even <em>add</em> a new varietal here.  I think I may have to go with the drill-down method where by I push another table view onto the stack to select (and possibly add) a varietal.  For another day.</p>

<p>Lastly, I took a stab at a better home screen:</p>

<p><img src="/images/wine_brain_homescreen.jpg" alt="Home Screen"></p>

<p>This pretty-well represents the ways I <em>think</em> I&#39;d want to navigate the data.  Time will tell once I implement these searches, but this seems like a reasonable start.</p>

<p>I also have to say that, despite Objective-C&#39;s overall wackiness, it was pretty easy to put this together and have the &quot;Add New Wine&quot; button bring up the &quot;Add Wine&quot; screen and to have the &quot;All Wines&quot; button navigate to the old home screen.  Apple has done a reasonable job of making it easy to make an idiomatic, normal-looking iPhone app.</p>

<p><em>Continued in <a href="/blog/2010/07/08/iphone-app-part-4.html">Part 4</a>, and <a href="/blog/2010/07/18/iphone-app-part-5.html">Part 5</a></em></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/06/27/iphone-app-part-2.html">My first iPhone App - Part 2</a></h1>
        
        <h2 class="f6 mtneg">June 27, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/23/iphone-app-part-1.html">Part 1</a> first</em></p>

<p>For the past several days I&#39;ve had the app on my phone and used it to enter in wines to see how the UI was working.  Yesterday, I integrated
Core Data (Apple&#39;s Object/Relational Mapper (ORM), for lack of a better description) so that I could actually <em>save</em> some data.  I discovered some nuances to using Core Data, as well as a refinement in the UI.</p>

<h2>UI</h2>

<p>Last night, I had both my girlfriend Amy and my good friend Clay (who is also reasonably into wine) play around with the &quot;new wine&quot; screen.  Neither have an iPhone, and there were a few obvious problems:</p>

<ul>
<li>They were very unaccustomed to the &quot;Done&quot; button being in the upper-right corner, as well as the &quot;slot-machine&quot; control</li>
<li>Both had trouble with the &quot;Wine Name&quot; concept</li>
<li>Both had trouble dismissing the keyboard</li>
<li>Clay thought he was entering search terms and not a new Wine</li>
</ul>

<p>Later that evening, I had a glass of wine at a bar and entered it into my app.  Up until this point, I was just typing in wines I knew about, so this was the first &quot;real use&quot; of the app in the field.  I quickly realized that the &quot;Wine Name&quot; concept, while important, was too vague and confusing to be the first field you enter.  Most wines are known by the vineyard and some don&#39;t even have proper names or appellations.  So, I swapped the fields and added some examples in the placeholder text:</p>

<p><img src="/images/wine_brain_new_wine_comparison.jpg" alt="Comparison"></p>

<p>I also added a title to indicate that this screen is for adding a new wine.  Finally, I used the <a href="http://stackoverflow.com/questions/804563/how-to-hide-the-keyboard-when-empty-area-is-touched-on-iphone">background button trick</a> along with some events on the rating and type controls to dismiss the keyboard if you tap anywhere outside of a text field.</p>

<p>This feels much cleaner and flows a bit better.  While varietal is probably the third most important thing (at least for New World wines), the slot-machine control would be awkwardly placed right below the vineyard/vintage text fields, so I left it where it was.</p>

<p>As to Clay and Amy&#39;s confusion over some idiomatic iPhone design choices, I&#39;m not worrying about them a whole lot; a typical iPhone user will understand what&#39;s going on (I hope :).</p>

<h2>Core Data</h2>

<p>Backing all this is Apple&#39;s Core Data, which grew out of the <a href="http://en.wikipedia.org/wiki/Enterprise_Objects_Framework">Enterprise Objects Framework</a> (and was, incidentally, my first exposure to an ORM way back in 1998), is the simplest and most idiomatic way to store and manage data on the iPhone.  As with Interface Builder, you create the model visually, using a simplistic data modelling tool.  I set up the bare bones of my data model and generated the classes.</p>

<p><img src="/images/wine_brain_data_model.jpg" alt="Data Model"></p>

<p>The first problem I ran into was in changing the model after the database had been created on the device.  Core Data doesn&#39;t migrate your model for you by default.  I ended up starting over with a &quot;versioned&quot; model and implementing their default migration.  This will probably work for simple changes, but for more complex changes, it looks like it&#39;s somewhat difficult to migrate the model.  An unfortunate reason to do some Big Design Up Front.</p>

<p>My next problem was initializing reference data.  In my case, I wanted the list of varietals as well as the list of wine types (e.g. &quot;red&quot;, &quot;white&quot;) to be in the database and managed by Core Data.  I ended up creating an array of the values inside the app and then checking the database for their existence, adding them if they were missing.  It&#39;s a bit cheesy, but I can extract the lists to plist files later.  It <em>did</em> give me a chance to play with Objective-C&#39;s blocks feature.  I needed to map my list of <code>Varietal</code> objects to a list of strings, so I could compare that list against my default list.  While <code>NSArray</code> doesn&#39;t provide a map function, it does provide the equivalent of Ruby&#39;s <code>each</code> or Scala&#39;s <code>foreach</code>.  In true Apple/Objective-C style, it&#39;s called <code>enumerateObjectsUsingBlock</code> :)</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableArray</span> <span class="nl">arrayWithCapacity</span><span class="p">:[</span><span class="n">array</span> <span class="n">count</span><span class="p">]];</span>
<span class="p">[</span><span class="n">array</span> <span class="nl">enumerateObjectsUsingBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">id</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">NSUInteger</span> <span class="n">i</span><span class="p">,</span> <span class="kt">BOOL</span> <span class="o">*</span><span class="n">stop</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">strings</span> <span class="nl">addObject</span><span class="p">:[</span><span class="n">obj</span> <span class="nl">valueForKey</span><span class="p">:</span><span class="s">@&quot;name&quot;</span><span class="p">]];</span>
<span class="p">}];</span></code></pre></div>

<p>The <code>stop</code> pointer is an out-only variable that you set to YES to allow for an early exit from the loop.  I&#39;m glad they&#39;ve adopted this functional style; I forsee explicit loops becoming just as quaint as GOTOs in the near future.</p>

<p>One thing bugged me about this process, however.  I had these generated classes and it wasn&#39;t clear how to add my own methods to them without losing the code every time I re-generated my model.  Enter <a href="http://github.com/rentzsch/mogenerator">mogenerator</a>.  This provides a more sophisticated bit of code generation, givng you two classes for each model: one for machines (i.e. for Core Data to manage) and a subclass for people (to which I can add custom methods).  Perfect!  I wasn&#39;t able to incorporate it into XCode, but I&#39;m happy running in on the command line as needed for now.</p>

<h2>Random Bits</h2>

<p>I spent more time than I would&#39;ve liked tracking down a nasty bug where every attempt to convert a string to a number (for the wine vintage year) resulted in a <code>nil</code> number.  It turns out I was confused about when some object lifecycle methods were being called and my pointer to an <code>NSNumberFormatter</code> was, in fact, pointing to <code>nil</code>.  Unlike Java, where you&#39;d get a <code>NullPointerException</code>, or C, where you&#39;d get a core dump, it seems Objective-C just returns <code>nil</code> and doesn&#39;t even issue a warning.  Very strange.  Once I realized that, the solution was obvious.</p>

<p>I&#39;m still not 100% sure I&#39;m structuring my code properly, but Stack Overflow&#39;s stalwart iPhone SDK answerers have been <em>incredibly</em> helpful in pointing me in the right direction.</p>

<h2>Next Steps</h2>

<p>Now that I&#39;ve got the ability to save and retrieve data, the next step is to start looking to browsing, viewing, and editing the database.  I think the domain is restricted enough that I can use the iPhone&#39;s idiomatic drill-down table navigation to filter the database.</p>

<p>Continued in <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a>, <a href="/blog/2010/07/08/iphone-app-part-4.html">Part 4</a>, and <a href="/blog/2010/07/18/iphone-app-part-5.html">Part 5</a></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/06/23/iphone-app-part-1.html">My first iPhone App - Part 1</a></h1>
        
        <h2 class="f6 mtneg">June 23, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <h2>Background</h2>

<p>Last year, I spent most of my free time becoming familiar with Ruby, Rails, and Scala.  I&#39;m by no means an expert, but I&#39;m trying
to follow the advice of the <a href="http://www.pragprog.com">Pragmatic Programmers</a> and learn a new language/system every year.  This year, it&#39;s
going to be the iPhone API and Objective-C.  I coded some WebObjects applications in Objective-C many years ago, so the language
isn&#39;t totally unfamiliar, but the iPhone SDK, obviously, is.  After working my way through the first several
chapters of the <a href="http://pragprog.com/titles/amiphd/iphone-sdk-development">Dudney and Adamson&#39;s &quot;iPhone SDK Development&quot;</a> book, I decided I was ready to try my first real app.</p>

<h2>First App</h2>

<p>My girlfriend and I enjoy wine, but are largely novices.  On a trip to Napa we started writing down the wines we&#39;d tried and keeping personal
ratings of them.  The idea being twofold: try to remember good wines/avoid bad ones, and try to hone in on what our tastes are.  There are
so many wines and so many flavors and smells, it&#39;s just impossible to keep in your head.  So, I created a Google Spreadsheet and a form to allow us to enter wines on the go, via our smart phones.  The Goolge Docs form is less than usable, and this seems like the perfect job for a native iPhone app.</p>

<h3>User Experience</h3>

<p>Aside from learning the ins and outs of the SDK, another main goal is focus on making a highly-usable application (at least for myself and my girlfriend).  So, before diving into Core Data and modelling the domain, my first version of the applicaton simply presents the &quot;add a new wine&quot; screen.  This will be the screen I spend the most time in, and it&#39;s important to make it fast and easy.</p>

<p>The Google Spreadsheet currently collects:</p>

<ul>
<li>Wine Name</li>
<li>Vineyard</li>
<li>Vintage (year)</li>
<li>Varietal</li>
<li>Type (e.g. red/white)</li>
<li>Where we had</li>
<li>When we had</li>
<li>My rating</li>
<li>Her rating</li>
<li>Tasting Notes</li>
</ul>

<p>That&#39;s obviously too much for one iphone screen, and, if I&#39;m entering something in a hurry, I might not have time to go through all that.  Further, I think adding multiple ratings makes things a bit confusing, so I focussed my screen on the identifying characteristics (name/vineyard/vintage), the rating, and the type:</p>

<p><img src="/images/wine_brain_new_wine_1.jpg" alt="First Attempt"></p>

<p>As you can see, I tried to fit the &quot;where&quot; on the bottom, as well as a &quot;enter more information&quot; button.  After loading this on the phone, it was just not working out, plus I was missing the varietal, which is fairly important (at least to me).  </p>

<p>My next attempt simply ignores the &quot;add more&quot; concept, and, by using the segmented control, I was able to fit the type into a more compact area, while including the varietal as a &quot;slot-machine&quot;/picker.</p>

<p><img src="/images/wine_brain_new_wine_2.jpg" alt="Second Attempt"></p>

<p>My plan is to load this onto the phone and try using it the next few times I&#39;m out.  I figure I can do without the tasting notes or location if it keeps the UI simple</p>

<h3>The Code</h3>

<p>Objective-C and XCode are a whole different world from Java or Ruby.  First thing that bit me is the memory management.  I was familiar
with the rules (or so I thought).  Basically, if you call a method like &quot;copyXXX&quot; or &quot;initXXX&quot; to create a new object, you must
<code>release</code> it when you are done with it.  If you get access to an object through any other means, you should <em>not</em> release it.</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// my class has an NSArray called varietals that I&#39;m initializing here</span>
<span class="n">varietals</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSArray</span> <span class="nl">arrayWithObjects</span><span class="p">:</span>
                  <span class="s">@&quot;Barbera&quot;</span><span class="p">,</span>
                  <span class="s">@&quot;Cabernet Franc&quot;</span><span class="p">,</span>
                  <span class="c1">// snip</span>
                  <span class="s">@&quot;Zinfandel&quot;</span><span class="p">,</span>
                  <span class="s">@&quot;Other&quot;</span><span class="p">,</span>
                  <span class="nb">nil</span><span class="p">];</span></code></pre></div>

<p>Since I&#39;m <em>not</em> calling an &quot;init&quot; style method, I figured I didn&#39;t need to release it in <code>dealloc</code>. For some reason, this made me decide that I didn&#39;t need to <code>retain</code> it.  This caused my first crash and trip through the debugger to figure out what in the heck is going on.</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// my class has an NSArray called varietals that I&#39;m initializing here</span>
<span class="n">varietals</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSArray</span> <span class="nl">arrayWithObjects</span><span class="p">:</span>
                  <span class="s">@&quot;Barbera&quot;</span><span class="p">,</span>
                  <span class="s">@&quot;Cabernet Franc&quot;</span><span class="p">,</span>
                  <span class="c1">// snip</span>
                  <span class="s">@&quot;Zinfandel&quot;</span><span class="p">,</span>
                  <span class="s">@&quot;Other&quot;</span><span class="p">,</span>
                  <span class="nb">nil</span><span class="p">]</span> <span class="k">retain</span><span class="p">];</span></code></pre></div>

<p>Since I needed <code>varietals</code> to survive the method where I was initializing it, I had to <code>retain</code> it.</p>

<h3>Other struggles</h3>

<p>Interestingly, laying out the UI and getting that hooked up isn&#39;t too bad; the thing I&#39;m having the most trouble with is figuring out what is the &quot;unsurprising&quot; way of doing things; tutorial code from books is rarely very well written; it&#39;s usually done in a certain way to make concepts clear, but I haven&#39;t yet found a definitive &quot;here&#39;s how you organize your code&quot; or &quot;iPhone best practices&quot; that seems relatively comprehensive.</p>

<p>At any rate, I figure if I can get the UX to be reasonably good, the rest should sort itself out.</p>

<p>I&#39;ll continue posting about my progress here on my blog.  If I can get the app polished and working, my girlfriend might demand and Android version.  Would be interesting to compare the two paradigms (especially since Android is all Java, which has been my bread-and-butter for many years).</p>

<p><a href="/blog/2010/06/27/iphone-app-part-2.html">Continued in Part 2</a>, <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a>, <a href="/blog/2010/07/08/iphone-app-part-4.html">Part 4</a>, and <a href="/blog/2010/07/18/iphone-app-part-5.html">Part 5</a></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/06/14/in-defense-of-vi.html">In defense of vi</a></h1>
        
        <h2 class="f6 mtneg">June 14, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>Sadly, I was unable to attend <a href="http://www.railsconf.org">RailsConf</a> this year.  It was in Baltimore, and it would&#39;ve been a lot of fun, but it just wasn&#39;t in the cards.  One of the great things about RailsConf is that the videos are posted online very quickly and are always of high quality.  While I always like hearing <a href="http://www.youtube.com/watch?v=b0iKYRKtAsA">DHH</a> speak, I try to never miss one of <a href="http://www.twitter.com/unclebobmartin">Uncle Bob Martin</a>, author of the must-go-read-this-right-now <a href="http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1276567370&amp;sr=8-1">Clean Code</a>.</p>

<p>This year, he gave an <a href="http://www.youtube.com/watch?v=mslMLp5bQD0">awesome talk</a> on the (lack of) innovation in software development.  He pointed out that we were still writing the same type of code now as we were 40 years ago.  In one part, he asks the crowd what editor they use (knowing full well most will say <a href="http://www.vim.org">vim</a>).  He then proceeds to make light of the audience for using a 19-year-old editor based on a 34-year-old editor.  While his criticism is brief, I think it speaks more to the sorry state of text editing than to the developers (like me) who are &quot;still&quot; using vim.</p>

<p>I&#39;m sure that unclebob is one of the more advanced IDE users, but it just <em>pains</em> me watching my co-workers meander through their code, selecting things with the mouse, and deleting long swaths of text by just hitting the delete key a lot. </p>

<p>While an IDE is great for learning a new environment (especially one as pedantic and verbose as Java or Objective-C), the editing capabilities are counter-intuitive and degenerate.  vim may be hard on the newbie, but it&#39;s intuitive and logical.  When you understand the &quot;zen&quot; of vim, you can fly through your code, playing it like a musical instrument.  It <em>affords</em> muscle memory and allows sophisticated chaining of movement, intent, and action.  You can <em>see</em> what you want to accomplish and your hands make it so, all without reaching for a mouse, cursoring, using the delete key, or contorting your hand with some awful combination of key modifiers.</p>

<p>Think of it as a piano; it&#39;s a very simple base of simple sounds and actions that, when chained together, can be used to make beautiful music.  An IDE is more like a fancy Casio keyboard with built-in songs and beats.  Shiny, but hollow.</p>

          </section>
        
      
    </article>
  
  <footer class="center border-top">
    <nav class="pt2 pb2">
      
        <a class="fw-bold prev pr2" href="page12">&larr; Older</a>
      
      <a class="" href="/blog/archives">All Posts…</a>
      
        <a class="fw-bold next pl2" href="page10">Newer &rarr;</a>
      
    </nav>
  </footer>
</div>

    </section>
  </main>
  <footer class="center">
    <p class="f6">
      Copyright &copy; 2006-2015, by David Bryant Copeland, All Rights Reserved
  </footer>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body></html>
