
<!DOCTYPE html>
<html language="en"><head>
  <meta charset="utf-8">
  <title>naildrivin5.com - David Bryant Copeland's Website</title>
  <meta name="author" content="David Bryant Copeland">
  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/images/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/images/favicons/ms-icon-144x144.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  

  
  <meta name="description" content="
  
  
  
    
      
        
        Why I'd never work for Google, Twitter, or Facebook
        
        August 01, 2011
      
      
        
...">
  

  
  <link rel="canonical" href="http://naildrivin5.com/page11/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="naildrivin5.com - David Bryant Copeland's Website" type="application/atom+xml">
  <link href="/css/styles.css" rel="stylesheet">
  <script src="https://use.typekit.net/ylm4zpa.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>
            
  <meta name="google-site-verification" content="h_yTpXa6N3ebHj8DYmgX4lIFGHBW1NtGMVHfXuu7i_4" />
</head>
<body>
  <header class="site-header pb2 mb2 center">
    <h1 class="uc ls2 f1"><a href="/">naildrivin5.com</a></h1>
    <h2 class="ls1"><small class="uc h4">Website of</small> David Bryant Copeland</h2>
    <nav>
      <ul>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/">Blog</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/bio">About</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/books">Books</a></li>
        <li class="text-c w-1-3"><a class="ib w-100 button" href="/talks">Talks</a></li>
      </ul>
      <div style="clear: both"></div>
    </nav>
  </header>
  <main>
    <section>
      <div class="blog-index">
  
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/08/01/why-i-wont-work-for-google-twitter-facebook.html">Why I'd never work for Google, Twitter, or Facebook</a></h1>
        
        <h2 class="f6 mtneg">August 01, 2011</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>Just got back from OSCON 2011.  There were some really interesting talks, and “the big three” were all over the place: Google, Twitter, and Facebook.  I attended the <a href="http://www.oscon.com/oscon2011/public/schedule/detail/20528">Twitter talk</a> on how they moved from Ruby to the JVM, as well a talk by Rob Pike (of Google) on <a href="http://www.oscon.com/oscon2011/public/schedule/detail/18653">Go</a>.  I use Twitter and Google a <em>lot</em>, and enjoyed hearing about how they work (Facebook, on the other hand, I use begrudgingly).</p>

<p>My first reaction to these talks was “Wow, it sure sounds like a lot of fun to work at these places!” From inventing programming languages to using Scala to scale a massive architecture, it sounds like developer shangri-la.  Until recently, I was slinging <a href="/blog/2010/01/09/Top-5-Omissions-From-Spring-MVC.html">Spring MVC</a> code in vanilla Java.  Sucks for me, right?</p>

<p>This is lazy thinking, and I haven&#39;t fallen victim to it in quite a while.  Ask yourself: “Why would Google spend the time and money to get Rob Pike to work for them and invent an entirely new programming language?”  Ask: “Why would Twitter spend the time and money to design and deploy an elegant, scalable architecture using the JVM and Scala?”</p>

<p>An awesome new programming language, or an impressive, scalable architecture is not an end to itself.  These are tools that serve some other purpose.</p>

<p>In the case of Google, Twitter, and Facebook, that purpose is to serve ads.</p>

<p>Although <a href="http://www.youtube.com/watch?v=vKmQW_Nkfk8">Steve Yegge&#39;s</a> keynote features him “quitting” his project at Google (which he describes as “sharing cat pictures”) to work on some higher calling (still within Google), he&#39;s just trading one ad-serving system for another.  </p>

<p>Google+ isn&#39;t about sharing cat pictures, it&#39;s about serving ads.  Twitter&#39;s massive network of 140-character bits of information isn&#39;t about connecting people across the globe or to view current trends in worldwide thinking, it&#39;s about serving ads.  Facebook isn&#39;t about entertaining yourself with games or sharing interesting links, it&#39;s about serving ads.</p>

<p>So, why are the best and brightest in the industry busting their asses to work at these places?   If all you care about is watching performance metrics increase, or playing with something new, or just watching lots of tests pass, I guess it&#39;s nice to get paid well.  But, how can this be truly fulfilling?  For me, it wouldn&#39;t be.  I need the tools I&#39;m building, the products I work on, and the architecture I&#39;m helping to create to all serve something I&#39;m interested in.</p>

<p>I&#39;m not saying that my code needs to save the world or support humanitarian causes, but it should at least be something that <em>I</em> like, or <em>I</em> would use, or that <em>I</em> care about.</p>

<p>And I can&#39;t fucking abide advertisements.  Honestly, I don&#39;t know anyone who does.  Except, apparently, a lot of really smart software engineers.</p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/04/28/I-spent-a-dollar.html">I spent a dollar on something that's free</a></h1>
        
        <h2 class="f6 mtneg">April 28, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>Co-worker sent out an email today, letting everyone know about a handy Mac app called <a href="http://code.google.com/p/cdto/">cdto</a>.  You drag it to Finder and, if you
click it, it will open a Terminal window where the current working directory is the folder you&#39;re viewing in Finder.  Pretty handy.</p>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/04/28/I-spent-a-dollar.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/04/06/hyperscheduling.html">Hyperscheduling - How I find time to do things I hate</a></h1>
        
        <h2 class="f6 mtneg">April 06, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><blockquote>
<p>You don&#39;t need schedule time to play video games</p>
</blockquote>

<p><a href="http://www.kungfugrippe.com/">Merlin Mann</a> has said this more than a few times on his great <a href="http://5by5.tv/b2w">podcast</a> with <a href="http://twitter.com/danbenjamin">Dan Benjamin</a>, and it
really strikes a chord with me.  Not that I play video games (I don&#39;t), but the underyling message really speaks to me: “you don&#39;t need to schedule time to do
things you <em>really</em> want to do.”</p>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/04/06/hyperscheduling.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/04/02/why-not-use-bash.html">Why not use bash?</a></h1>
        
        <h2 class="f6 mtneg">April 02, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>At <a href="http://www.rubynation.org">RubyNation</a>, I gave a talk on <a href="http://awesome-cli-ruby.heroku.com">Making Awesome Command Line Applications in Ruby</a>, which I&#39;ve done a few times, and is what led to my currently-in-progress book on the subject.  </p>

<p>One of the assertions I added to the talk, based on my work on the book is the specific advice to not start off in bash…use Ruby.  This was questioned by a member of the audience (who I realized later was <a href="http://twitter.com/bmizerany">Blake Mizerany</a> of Heroku/Sinatra fame, i.e. someone far more knowledgable than me about CLI apps, Ruby, and shell programming).</p>

<p>My answer was about as eloquent as a middle-school debate team closing argument and amounted to “Me hate bash.”</p>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/04/02/why-not-use-bash.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/01/10/2010-one-weed-of-ipad.html">One Week of using my iPad for personal stuff at work</a></h1>
        
        <h2 class="f6 mtneg">January 10, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>On Jan 3, I <a href="http://twitter.com/#!/davetron5000/status/21943399506509824">tweeted</a>:</p>

<blockquote>
<p>All personal stuff only on iPad; no twitter, email, or RSS on work computer. Will it keep me more focused?</p>
</blockquote>

<p>Essentially, what I decided to try doing was to bring my iPad to work every day, and use it for Twitter, RSS, and personal emails.  The only &quot;personal&quot; stuff I would be doing on my work machine would be IM, simply because the IM experience on iPad is not very good, and the immediacy of it would be lost on a computer that&#39;s not right in front of me.  I don&#39;t do a lot of personal IM&#39;ing anyway, so this seemed like a good compromise.</p>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/01/10/2010-one-weed-of-ipad.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2011/01/01/2010-whats-next.html">2010 in review; what's next for me in 2011</a></h1>
        
        <h2 class="f6 mtneg">January 01, 2011</h2>
      </header>
      
        <section class="mb1">
          <div class="excerpt"><p>Yesterday, while waiting for guests to arrive at my mostly-annual New Year&#39;s Eve party, I found a txt file I created called <code>2010_goals.txt</code>.  It&#39;s contents:</p>

<ul>
<li>speak at at least one more user&#39;s group</li>
<li>speak at some sort of conference</li>
<li>deploy an App to the iPhone App Store</li>
<li>Deploy a Rails 2 app to Heroku</li>
</ul>
</div>
          <footer class="mb2 text-l">
            <a rel="full-article" class="no-ul pill" href="/blog/2011/01/01/2010-whats-next.html">Read More…</a>
          </footer>
        </section>
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/08/24/static-vs-dynamic-typing-is-typing.html">Static vs. Dynamic Typing: A matter of keystrokes?</a></h1>
        
        <h2 class="f6 mtneg">August 24, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>In Java, I almost <em>never</em> make type errors.  The type errors that are possible in Java fall roughly into two categories:</p>

<ol>
<li> Using an object of the wrong type (this is caught by the compiler)</li>
<li> Casting an object to a more specific type at runtime (this can only be caught by tests or users :)</li>
</ol>

<p>I&#39;d make error #1 on occasion, but the compiler catches it.  As to #2, before generics, I can count on my hands the number of times I got a bona-fide <code>ClassCastException</code> at runtime.  After generics?  Never.  </p>

<p>I don&#39;t mean just that I didn&#39;t experience these runtime type errors, but that they <em>didn&#39;t even make it to the compiler</em>.  If you think about how Java syntax works, it&#39;s no wonder:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">someList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">someList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;Foo&quot;</span><span class="o">);</span>
<span class="n">someList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;Bar&quot;</span><span class="o">);</span></code></pre></div>

<p>I had to type almost the exact same thing twice.  After about 2 days of using generics, my muscle memory literally <em>prevents</em> me from making type errors.  To even simulate one requires a pre-generics library call, or some herculean efforts.  An arguable win for static typing, if at the price of verbosity.</p>

<p>Of course, in Ruby, I make type errors all the time, especially when using new libraries I&#39;m not familiar with.  Ruby libraries rarely document the types of things (though they are frequently liberal with what they will accept).  The solution here is just better unit tests.  And that&#39;s a pretty good thing.  So, a slight negative for dynamic typing that leads us to a better tested system, reduced verbosity, and better productivity once the learning curve is dealth with.</p>

<p>This pretty well illustrates the tradeoffs between dynamic and static typing.  Case closed, right?</p>

<p>Enter Scala.  With Scala, I make type errors just as much as I do with Ruby.  The only difference is that the compiler catches them.   Here&#39;s the Scala equivalent to the Java code above</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">var</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="s">&quot;bar&quot;</span><span class="o">)</span></code></pre></div>

<p>Notce how I haven&#39;t specified a <em>single</em> type?  It&#39;s nearly identical to the Ruby version:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">list</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="s2">&quot;bar&quot;</span><span class="o">]</span></code></pre></div>

<p>These examples are obviously simplistic, but in a more complex system, Scala&#39;s type inferencer tends to be one
step ahead of me.  While it&#39;s handy that I have a compiler to catch these type errors, the fact remains that, despite Scala being a statically typed language, <em>I&#39;m making far more type errors than I would in Java</em>.</p>

<p>This seems kindof odd, but I think it&#39;s ultimately a win: I get the brevity and productivity of a dynamically typed language, but the safety of the compiler catching my type errors for me.</p>

<p>Scala puts a subtle spin on the &quot;static vs. dynamic&quot; debate, because you aren&#39;t annotating your types <em>nearly</em> as much as with Java, but you still get all the benefits.  I&#39;ve certainly heard many criticisims of static typing, but having the compiler check types for you wasn&#39;t one of them.</p>

<p>Of course, sometimes you <em>do</em> need to tell Scala what your types are, but, they seem to be exactly where you&#39;d want them anyway:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/** get users with the given name and age */</span>
<span class="k">def</span> <span class="n">getUsers</span><span class="o">(</span><span class="n">name</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span><span class="n">age</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">User</span><span class="o">]</span></code></pre></div>

<p>This says that we take a requires <code>String</code> and an optional <code>Int</code> and will return a list of <code>User</code> objects.  To give the same information in Ruby, you&#39;d need to:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Gets the users with the given name and age</span>
<span class="c1">#</span>
<span class="c1"># name - a String</span>
<span class="c1"># age - an Int or nil if not searching by age</span>
<span class="c1">#</span>
<span class="c1"># Returns an array of User objects</span>
<span class="k">def</span> <span class="nf">get_users</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="kp">nil</span><span class="p">)</span>
    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
<span class="k">end</span></code></pre></div>

<p><em>(Sure, you could leave off the comment, but do you really hate your fellow developers (<em>and</em> future you) that much?)</em></p>

<p><em>Now</em> which language is more verbose?  Perhaps the static/dynamic typing debate is really just about entering text?</p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/30/in-offense-of-scala-option.html">In "Offense" of Scala's Option class; a guarded defense of Cédric's rant</a></h1>
        
        <h2 class="f6 mtneg">July 30, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p>In a <a href="http://beust.com/weblog/2010/07/28/why-scalas-option-and-haskells-maybe-types-wont-save-you-from-null/">recent blog entry</a>, Cédric Beust calls out scala&#39;s <code>Option</code> class as nothing more significant than null checks.  Commenters rightly set him straight that the thesis of his blog post was marred by an ignorance of idiomatic use of the class.</p>

<p>But, it&#39;s hard to really blame Cédric, when you look at what he had to go on.  Odersky&#39;s book states that one should use pattern matching with <code>Option</code>, and the scaladoc for Option is just abysmal:</p>

<blockquote>
<p>This class represents optional values. Instances of Option are either instances of case class Some or it is case object None.</p>
</blockquote>

<p>That is the <em>entire</em> description of the class, no examples, nothing.  Worse, the method that commenters called out as idiomatic, <code>flatMap</code>, has the following description:</p>

<blockquote>
<p>If the option is nonempty, return a function applied to its value. Otherwise return None.</p>
</blockquote>

<p>This is <em>not</em> what <code>Option#flatMap</code> actually appears to do (nor is documented to do; it&#39;s documented to return an <code>Option[B]</code>!):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">s</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">n</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">f</span> <span class="k">=</span> <span class="o">{</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Some</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="s">&quot;bar&quot;</span><span class="o">)</span> <span class="o">}</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="nc">Some</span><span class="o">(</span><span class="n">foobar</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">n</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="nc">None</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">s</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
<span class="n">r</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">java.lang.String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">foobar</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">getClass</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">java.lang.Class</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span> <span class="k">class</span> <span class="nc">scala</span><span class="o">.</span><span class="nc">Some</span></code></pre></div>

<p>It certainly doesn&#39;t call itself out as &quot;the way&quot; to use Option.  A simple example in the scaladoc could have gone a long way.</p>

<p>So, angry post + helpful commenters == problem solved, right?</p>

<p>Wrong.</p>

<p>The <code>Option</code> class is, really, an implementation of the <a href="http://en.wikipedia.org/wiki/Null_Object_pattern">NullObject</a> pattern, and a more elegant way to handle optional values.  In scala, we might have this method signature:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/**</span>
<span class="cm"> * Updates the full name</span>
<span class="cm"> * @param lastName the last name</span>
<span class="cm"> * @param firstName the first name</span>
<span class="cm"> */</span>
<span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span></code></pre></div>

<p>This means &quot;update my name; lastName is required and firstName is optional&quot;.  In java, this method might look like this:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**</span>
<span class="cm"> * Updates the full name</span>
<span class="cm"> * @param lastName the last name, may not be null</span>
<span class="cm"> * @param firstName the first name, may be null</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateName</span><span class="o">(</span><span class="n">String</span> <span class="n">lastName</span><span class="o">,</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">lastName</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;lastName required&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">StringBuffer</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">firstName</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">b</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span>
        <span class="n">b</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">this</span><span class="o">.</span><span class="na">fullName</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span></code></pre></div>

<p>So, what&#39;s the right way to do it in Scala?  According to the commentors:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">)</span>
  <span class="n">firstName</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span> <span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">)</span> <span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Yech.  Does anyone else think that calling a method called &quot;foreach&quot; on our &quot;optional value&quot; is just nonsensical?  Or that the <em>idiomatic way</em> to treat an optional value is <em>as a collection</em>, e.g. by using the <code>for</code> comprehension?  This just feels hacky.  Naming is one of the most important (and challenging) things in software engineering, and <code>Option</code>&#39;s API is an utter failure (even its name is wrong; when one has <em>an option</em>, one typicaly has many choices, not just one or nothing.  <em>Optional</em> is really what is meant here, so why are we afraid of adding a few more letters?  Especially given how &quot;precise&quot; some of the documentation is, mathematically speaking, why are we not being precise with English?). If <code>Option</code> is just shorthand for a &quot;list of zero or one elements&quot;, and we get no better methods than what comes with <code>List</code>, then what&#39;s even the point of the class?</p>

<p>I&#39;m not saying we remove all the collection methods from <code>Option</code>, but how about a throwing us a bone to make our code readable and learnable without running to the scaladoc (or REPL) to see what&#39;s going on?  I mean, there&#39;s a method on <code>Option</code> called <code>withFilter</code> whose documented purpose (I&#39;m not making this up) is: &quot;Necessary to keep Option from being implicitly converted to Iterable in for comprehensions&quot;.  Am I expected to believe that it&#39;s ok to have <em>this</em> hacky pile of cruft, but we can&#39;t get a readable method for &quot;do something to the contents if they are there&quot;?</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> 
  <span class="k">def</span> <span class="n">ifValue</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span> <span class="n">f</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">U</span> <span class="o">)</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="n">foreach</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">unlessValue</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span> <span class="n">f</span><span class="k">:</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="n">U</span><span class="o">)</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="o">)</span> <span class="n">f</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">updateName</span><span class="o">(</span><span class="n">lastName</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">firstName</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span><span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">(</span><span class="n">lastName</span><span class="o">)</span>
  <span class="n">firstName</span><span class="o">.</span><span class="n">ifValue</span><span class="o">(</span> <span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">);</span> <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="o">(</span><span class="n">firstName</span><span class="o">)</span> <span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Which would be less surprising?  Couple this with some better scaladoc:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="cm">/** This class represents an optional value.  </span>
<span class="cm"> *</span>
<span class="cm"> * To use as a null object:</span>
<span class="cm"> * val optional = getSomePossiblyOptionalValue</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * option.ifValue { (actualValue) =&gt; </span>
<span class="cm"> *   // do things with the value, if it was there</span>
<span class="cm"> * }</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> * or</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * optional.unlessValue { log.debug(&quot;missing optional value&quot;) }</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * To use as a Monad or collection:</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> * val first8upper = option.flatMap( (y) =&gt; Some(y.toUpperCase) ).</span>
<span class="cm"> *                          flatMap( (y) =&gt; Some(y.substring(0,8)) )</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Option</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
  <span class="c1">// etc.</span>
<span class="o">}</span></code></pre></div>

<p>With these examples, you cover the two main uses of this class, show newcomers how to use it, and demonstrate its superiority over null checks.</p>

<p>It&#39;s frustrating to see this, because Scala has so much potential to be a lucid, accessible, readable language, but API usability and learnability are just not prioties.  Scala needs to take some lessons from Ruby in terms of API design (and Java in terms of API documentation).</p>

<p>Of course, none of this <em>does</em> save you from null, because Scala is perfectly happy to assign null to anything.  It kinda makes the whole thing seem a bit pointless.</p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/18/iphone-app-part-5.html">My first iPhone App - Part 5</a></h1>
        
        <h2 class="f6 mtneg">July 18, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/23/iphone-app-part-1.html">Part 1</a>, <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 2</a>, <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a>, and <a href="/blog/2010/07/08/iphone-app-part-4.html">Part 4</a> first</em></p>

<p>I&#39;ve been working on the app more than my recent lack of blog entries indicates.  At this point, I have what could roughly be called a beta version; almost all the features are there, and things seem to be generally working pretty well.  </p>

<h2>User Experience</h2>

<p>The biggest change in the UX is the ability to add tasting notes, date tasted, and location tasted.  This is a new screen accessible from the main entry screen.  The most obvious way to do this in my mind, was a big button at the bottom:</p>

<p><img src="/images/wine_brain_new_wine_5.jpg" alt="New Add Screen"></p>

<p>In designing the new screen, 
the &quot;where tasted&quot; and &quot;when tasted&quot; were straightforward; I used stock controls.  For the tasting notes, I needed a <code>UITextView</code>, which is akin to an HTML <code>TEXTAREA</code>.  The visual appearance of this control is pretty lacking compared to the <code>UITextField</code>; there is no nice beveled edge, no rounded corners, and no placeholder text.  I really just wanted a multi-line field much like the <code>UITextField</code>, but there is nothing available to create that.</p>

<p>So, I hacked something together.</p>

<p>An option for the <code>UITextField</code>&#39;s appearance is to have a beveled edge with square corners.  In this configuration, you can adjust the height of the text field.  So, I placed such a field on the screen and sized it about the size of my tasting notes field and made the background color white.  I then put the tasting notes field on top of it, with a clear background color, and, well, it looked pretty good:</p>

<p><img src="/images/wine_brain_new_wine_details.jpg" alt="Details Screen"></p>

<p>I then implemented some <code>UITextViewDelegate</code> methods to give the apperance of placeholder text:</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">textViewShouldBeginEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="n">DEFAULT_TASTING_NOTES_TEXT</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">textViewDidEndEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="n">length</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">DEFAULT_TASTING_NOTES_TEXT</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>I considered using some third-party controls that mimic this behavior, but didn&#39;t want to get side-tracked adding new frameworks to my app at this point.</p>

<h2>User Testing</h2>

<p>Once I had this, I handed my phone to Amy for some more user testing; She brought up a few obvious things that I had completely internalized and begun ignoring:</p>

<ul>
<li>Clicking &quot;Save&quot; on the details screen brought you back to the &quot;new wine&quot; screen, instead of just saving and bringing you back to the top.  A minor but obvious annoyance.</li>
<li>She kept tapping on the &quot;Choose Varietal&quot; text field, thinking that would bring up the varietal chooser, instead of clicking the much smaller blue &quot;disclosure&quot; button</li>
<li>She was a bit sad that the wines we had entered in the app would not be available on our shared Google Spreadsheet</li>
</ul>

<p>To smooth the navigation after saving, I used a stock feature of the <code>UINavigationController</code> to &quot;pop&quot; more than once up the chain.  Since my design of the details screen used Apple&#39;s delegate pattern (essentially, the &quot;add new wine&quot; view controller was the delegate to the details view&#39;s lifecycle; when you click &quot;Save&quot; on the detail view, it triggers a callback in the &quot;add new wine&quot; view controller; the perfect place to save before the detail view controller popped back two screens).</p>

<p>The problem with the &quot;Choose Varietal&quot; control had bugged me, too, but I got used to it and didn&#39;t think about it.  The solution was very simple, though hacky.  I placed a clear button on top of the field the exact size of the field and had it trigger the same action as the blue disclosure button.  Problem solved.</p>

<p>As to maintaining the list up on Google Docs, I think I may need to implement this sooner rather than later; I think it&#39;s important to be able to get your data out of an application, and Google Docs is a reasonably user-friendly way to do it (as opposed to emailing some CSV file).  </p>

<h2>Other Random Bits</h2>

<p>I still didn&#39;t get around to setting up iCuke for testing; I really should because I don&#39;t know what missing <code>retain</code> calls might be lurking.  I also finally created an icon, using a picture I took in Napa.  Not sure I like it, but it beats the white blob:</p>

<p><img src="/images/wine_brain_icon.png" alt="Icon"></p>

<p>(Taken from <a href="http://www.flickr.com/photos/davetron5000/3805675435/">my original</a>).</p>

<p>Finally, the app no longer starts up on the actual device.  A seemingly serious problem that I assume would be remedied by a re-install from scratch, however I have a few wines that I&#39;ve added and don&#39;t particularly wanted to lose them.  Not sure how I could gain access to the SQL database to get them out, but I&#39;m currently downloading the 4.0.1 update for my phone and the 2+ GB SDK update (!).</p>

<p><em>As a followup, I had to re-install the application from scratch, though I was able to access the SQLite database from an iTunes backup.  I <em>really</em> need to implement a quicker backup/export mechanism...</em></p>

          </section>
        
      
    </article>
  
  
    <article>
      <header>
        
        <h1 class="f4"><a class="no-ul ul-hover" href="/blog/2010/07/08/iphone-app-part-4.html">My first iPhone App - Part 4</a></h1>
        
        <h2 class="f6 mtneg">July 08, 2010</h2>
      </header>
      
        
          <section class="section-break complete-article mb1">
            <p><em>See <a href="/blog/2010/06/23/iphone-app-part-1.html">Part 1</a>, <a href="/blog/2010/06/27/iphone-app-part-2.html">Part 2</a>, and <a href="/blog/2010/06/29/iphone-app-part-3.html">Part 3</a> first</em></p>

<p>The past week was spent trying to understand the best way to expand my application&#39;s features without have a ton of duplicated code or UI.
It was also a learning experience on Core Data.  Thankfully, <a href="http://www.stackoverflow.com">Stackoverflow</a> and its amazing contributers were very helpful.</p>

<h2>Core Data Blunders</h2>

<p>It started as I made my first foray into implementing the search screen (i.e. the home screen of my app):</p>

<p><img src="/images/wine_brain_homescreen.jpg" alt="Home Screen"></p>

<p>Three of the searches (most recent wines, wines by rating, and all wines) end up doing the same thing more or less: Query for some data, sort it a certain way, and show it in a <code>UITableView</code>.  I ended up creating a custom table cell view and I wanted all three to use it:</p>

<p><img src="/images/wine_brain_custom_cell.jpg" alt="Custom Cell"></p>

<p>Access to Core Data-provided entities is done through objects of the class <code>NSFetchedResultsController</code>, which takes what amounts to a database query and provides many ways of accessing the results, including caching, callbacks, and iteration.  When using a table view, you typically have your view controller handle callbacks for this class, which allows the table to update itself when items are added, removes, or changed.  All of this boilerplate is given to you at the start of the project.  So far so good.</p>

<p>My plan was to create additional <code>NSFetchedResultsController</code> instances inside my table view controller class and then switch between them.  A fine idea that lead that numerous random difficult-to-reproduce crashes.</p>

<p>It turns out the basic idea of what I was doing was good, but my implementation exposed a sore lack of understanding of how all this stuff fit together.  I&#39;m still not sure I fully grasp it (and wish the book I bought had a bit of a deeper dive into Core Data), but after some more reasoning, I got around it.  Essentially, leaving the unused <code>NSFetchedResultsController</code> instances connected to my table view <em>and</em> having caching turned on <em>and</em> not properly reloading data when switching searches created a situation where they were all pretty confused about the underlying state of the database.</p>

<p>With some judicious management of these instances, as well as disabling caching, I now have a fully-functional &quot;Recent Wines&quot;, &quot;Wines By Rating&quot; and fancy indexed &quot;All Wines&quot; view (index meaning I can jump to wines by letter, a la the Contacts application).</p>

<p>Unfortunately, the result of turning off caching is that it takes a noticable blip of time to summon any of these views.  I may just come full circle and end up with three different <code>UITableViewController</code> instances and NIBs just so I can leave Caching on.</p>

<h2>User Experience</h2>

<p>Once I had gotten back to a stable app, I loaded it up on my phone and headed into the field.  A few nights ago, Amy and I ended up at one of our favorite restaurants/wine bars in DC, <a href="http://www.proofdc.com">Proof</a>.  We&#39;ve been there several times, and many of their wines-by-the-glass are in the Wine Brain.  While they rotate their selections, I was curious as to what I&#39;d had there previously.  Unfortunately, I had yet to implement the search-by-location feature :)  Combing through the &quot;All Wines&quot; view was a bit frustrating.  This made obvious several features that are now on the top of my list (some planned previously, some not):</p>

<ul>
<li>Find wines by location</li>
<li>Actually <em>entering</em> the location at which I had a wine</li>
<li>Location-aware assistance of location (e.g. &quot;Are you at Proof?  Here&#39;s what you&#39;ve had there...&quot;)</li>
<li>Ability to text-search the &quot;all wines&quot; list</li>
</ul>

<p>The good news is that my cursory reading of my book and the API docs indicates that these things are going to be <em>very</em> easy to implement.</p>

<h2>Objective-C</h2>

<p>There&#39;s a lot to like about Objective-C, and a lot to dislike.  Even though the handling of multiple arguments is a bit strange, I find it actually results in fairly readable code.  It feels very Apple; different, but usable.  Even though it&#39;s a lot to type out something like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">NSString *stripped = [canonicalName stringByTrimmingCharactersInSet:
                       [NSCharacterSet whitespaceAndNewlineCharacterSet]];
</code></pre></div>
<p>It <em>is</em> pretty readable, regardless of what programming language you are coming from.  That being said, stack traces and error messages on crashes are nigh-useless, and the overall testability of iPhone apps is pretty behind the times.  This months <a href="http://pragprog.com/magazines">issue of Prag Prog&#39;s magazine</a> has an interesting article on <a href="http://github.com/unboxed/icuke">iCuke</a>, which I look forward to trying out.  I&#39;ve resulted to keeping a text file of test cases that I have to manually run through to make sure I haven&#39;t broken anything, and it feels, well, 1997.  The rumours of a Apple&#39;s switch to Ruby are too good to be true, but one can always dream.</p>

<p><em>Continued in <a href="/blog/2010/07/18/iphone-app-part-5.html">Part 5</a></em></p>

          </section>
        
      
    </article>
  
  <footer class="center border-top">
    <nav class="pt2 pb2">
      
        <a class="fw-bold prev pr2" href="page12">&larr; Older</a>
      
      <a class="" href="/blog/archives">All Posts…</a>
      
        <a class="fw-bold next pl2" href="page10">Newer &rarr;</a>
      
    </nav>
  </footer>
</div>

    </section>
  </main>
  <footer class="center">
    <p class="f6">
      Copyright &copy; 2006-2016, by David Bryant Copeland, All Rights Reserved
    </p>
  </footer>
  <script type="text/javascript">
    var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '56a22cd9c88d90284f000861');
      t.setAttribute('data-track-path', 'https://track.gaug.es/track.gif');
      t.src = 'https://d36ee2fcip1434.cloudfront.net/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
  </script>
</body></html>
